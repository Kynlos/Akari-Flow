---
title: Auto Docs Generator
layout: default
---

# generate-docs.py

*Auto-generated from `.github/scripts/generate-docs.py`*

# Advanced Auto‑Documentation Generator – `generate‑docs.py`

> **What this module does**  
> `generate‑docs.py` is a CI‑friendly script that automatically produces API documentation, changelog entries, and PR comments for any code files that have changed in a Git repository. It works by:
> 1. Detecting which files changed (`changed_files.txt` is expected to be produced by a CI job).  
> 2. Extracting symbols from each file with **PolyglotAnalyzer** (Python, Go, TS/JS, Rust, Java, C/C++ …).  
> 3. Comparing the old and new versions to surface breaking changes.  
> 4. Sending the file content (and a diff preview) to a Groq LLM to generate Markdown documentation.  
> 5. Writing the docs to `docs/<file>.md`, updating `CHANGELOG.md`, and creating a PR comment (`doc_output.md`).

> **Key features**  
> * Diff‑aware documentation – only changed files are processed.  
> * Breaking‑change detection with auto‑labeling.  
> * Cross‑file impact analysis placeholder.  
> * Mermaid class diagram generation (via `diagram_generator`).  
> * Caching via `.github/doc_cache.json` to skip unchanged files.  
> * Configurable via `config/languages.json` and environment variables (`GROQ_API_KEY`, `LLM_MODEL`).  

---

## Exports

| Function | Purpose |
|----------|---------|
| `get_file_hash(content)` | Compute SHA‑256 hash of a file’s content. |
| `extract_symbols_detailed(content, file_path)` | Use `PolyglotAnalyzer` to extract a detailed symbol list (name, type, signature, exported flag, etc.). |
| `detect_breaking_changes(old_content, new_content, file_path)` | Compare two file versions and return a dict describing any breaking changes. |
| `get_git_diff(file_path)` | Run `git diff HEAD~1 HEAD <file>` and return the diff string. |
| `generate_documentation(file_context, file_path)` | Call the LLM to produce Markdown documentation for a file. |
| `generate_changelog_entry(file_path, old_content, new_content, breaking_info)` | Build a changelog snippet for a single file (returns `None` if no entry is needed). |
| `update_changelog(entries)` | Insert new entries into `CHANGELOG.md`. |
| `generate_smart_pr_comment(code_files, doc_files, breaking_changes, impacts, changelog_entries)` | Produce the final PR comment that reviewers see, summarising changes, docs, and impacts. |
| `main()` | Orchestrates the whole workflow: reads changed files, generates docs, updates changelog, and writes the PR comment. |

---

## Usage Examples

> **Prerequisites**  
> * `GROQ_API_KEY` must be set in the environment.  
> * `config/languages.json` should list supported file extensions.  
> * `changed_files.txt` must contain a newline‑separated list of changed files (generated by CI).  

### 1. Running the script

```bash
# In your CI job
export GROQ_API_KEY="sk-xxxx"
python .github/scripts/generate-docs.py
```

The script will:

1. Read `changed_files.txt`.  
2. Skip unchanged files (hash cache).  
3. Generate docs in `docs/`.  
4. Update `CHANGELOG.md`.  
5. Write a PR comment to `doc_output.md`.

### 2. Inspecting a single function

```python
# Suppose we want to see the signature of `detect_breaking_changes`
from pathlib import Path
import json

# Load the script as a module
import importlib.util, sys
spec = importlib.util.spec_from_file_location("gen", ".github/scripts/generate-docs.py")
gen = importlib.util.module_from_spec(spec)
sys.modules["gen"] = gen
spec.loader.exec_module(gen)

print(gen.detect_breaking_changes.__doc__)
```

*Last updated: 2025-12-25*